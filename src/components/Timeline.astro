---
import { supabase } from "../db/supabase";

const { data, error } = await supabase
  .from("timeline_items")
  .select("id, year, title, description")
  .eq("is_published", true)
  .order("sort_order", { ascending: true })
  .order("year", { ascending: true });

const timelineItems = data ?? [];

if (error) {
  console.error("Supabase timeline_items error:", error);
}
---

<section id="cronologia" class="bg-background-alt/60 py-16">
  <div class="mx-auto max-w-5xl px-6">
    <div class="text-center">
      <p class="text-xs font-semibold uppercase tracking-[0.3em] text-secondary">Cronolog√≠a</p>
      <h2 class="font-display text-3xl text-text-main sm:text-4xl">Estudios y camino de vida</h2>
      <div class="mx-auto mt-4 h-1 w-24 bg-primary"></div>
    </div>
    <div class="relative mt-16 space-y-12">
      <div class="timeline-line"></div>
      {timelineItems.map((item, index) => (
        <div
          class={`relative flex flex-col gap-6 md:items-center md:justify-between ${
            index % 2 === 0 ? "md:flex-row" : "md:flex-row-reverse"
          }`}
        >
          <div class="md:w-5/12"></div>
          <div class="z-10 h-4 w-4 rounded-full bg-primary ring-8 ring-background-alt"></div>
          <div class="rounded-2xl bg-white p-6 shadow-sm md:w-5/12">
            <span class="text-primary font-bold">{item.year}</span>
            <h3 class="mt-2 text-lg font-bold">{item.title}</h3>
            <p class="mt-2 text-sm text-slate-600">{item.description}</p>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>
